parse_dialogue_task:
  description: >
    Parse the following dialogue into structured speaker turns:

    {dialogue}

    You MUST call the dialogue_parser tool exactly once
    and return its output.
  expected_output: >
    A list of objects with keys: speaker and text.
  agent: dialogue_parser_agent


subjective_task:
  description: >
    Extract subjective clinical findings from the parsed dialogue ONLY.
    You are given structured speaker turns.
    You MUST NOT call dialogue_parser.
    You MUST call subjective_extractor exactly once.
    Return ONLY the tool output JSON.
  expected_output: >
    JSON with symptoms, duration, severity, additional_notes.
  agent: subjective_agent
  context:
    - parse_dialogue_task

history_subjective_task:
  description: >
    Extract patient-reported medical, medication, family, and social history.
    Use ONLY patient utterances from parsed dialogue.
    You MUST call history_subjective_extractor exactly once.
    Return ONLY the tool output JSON.
  expected_output: >
    JSON with past_medical_history, medications, family_history,
    social_history, and additional_notes.
  agent: history_subjective_agent
  context:
    - parse_dialogue_task




objective_task:
  description: >
    Extract objective clinical findings ONLY from clinician statements.
    Do NOT infer or add information.
    You MUST call objective_extractor exactly once.
    Return ONLY the tool output JSON.
  expected_output: >
    JSON with vitals, physical_exam, lab_results,
    imaging_results, and additional_notes.
  agent: objective_agent
  context:
    - parse_dialogue_task




assessment_plan_task:
  description: >
    You are a STRICT information restatement component.

    INPUTS:
    - Extracted subjective findings
    - Extracted objective findings

    YOUR TASK:
    Produce an assessment and plan using ONLY information that is
    EXPLICITLY PRESENT in the extracted inputs.

    CRITICAL RULES (NO EXCEPTIONS):
    - DO NOT diagnose diseases.
    - DO NOT infer medical conditions.
    - DO NOT generalize symptoms.
    - DO NOT suggest tests, referrals, treatments, or follow-ups.
    - DO NOT add explanations, commentary, or reasoning.
    - DO NOT use markdown formatting.
    - DO NOT use clinical terminology not present in the dialogue.

    ASSESSMENT RULES:
    - Each assessment item MUST be a symptom or problem explicitly stated.
    - Each supporting_evidence item MUST be an exact, full sentence copied verbatim from the dialogue or extracted inputs. Do NOT paraphrase or shorten.
    - If no problems are explicitly stated, return an empty list.

    PLAN RULES:
    - If the dialogue does NOT explicitly state next steps, output EXACTLY:
      "insufficient information"
    - Only include plan items if the clinician explicitly states them.

    OUTPUT FORMAT (STRICT JSON ONLY):
    {
      "assessment": [
        {
          "problem": "<verbatim problem phrase>",
          "supporting_evidence": ["<exact quoted phrase from dialogue>"]
        }
      ],
      "plan": "insufficient information" OR ["<verbatim clinician-stated step>"]
    }

    Any violation of these rules is an error.

  expected_output: >
    Strict JSON object with keys "assessment" and "plan" only.

  agent: assessment_plan_agent
  context:
    - subjective_task
    - objective_task